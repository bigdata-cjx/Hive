# 了解数据压缩
hive 的数据压缩 == MR的数据压缩
## 在哪个阶段进行数据压缩
### MR阶段过程
input -> map -> shuffle -> reduce -> output
### shuffle 阶段几个重要内容：
分区 -> 排序 -> combiner(map端的reduce) -> 压缩 -> 分组
### compression的阶段
map 输出  和   reduce 输出
## 为什么要数据压缩
1. 节省磁盘空间
2. 减小网络IO、磁盘IO
## 有哪些数据压缩方案
1. zlib 
2. gzip
3. bzip2
4. snappy（google 企业应用）
5. lz4
6. lzo

压缩效率：bzip2 > gzip > lzo 
解压速度：lzo > gzip > bzip2
# hadoop编译(添加 snappy 库)
## 检查本地库，查看是否有snappy压缩库
```
root@bigdata:/opt/modules/hadoop-2.6.0# bin/hadoop checknative
21/07/12 09:13:48 WARN bzip2.Bzip2Factory: Failed to load/initialize native-bzip2 library system-native, will use pure-Java version
21/07/12 09:13:48 INFO zlib.ZlibFactory: Successfully loaded & initialized native-zlib library
21/07/12 09:13:48 ERROR snappy.SnappyCompressor: failed to load SnappyCompressor
java.lang.UnsatisfiedLinkError: Cannot load libsnappy.so.1 (libsnappy.so.1: cannot open shared object file: No such file or directory)!
	at org.apache.hadoop.io.compress.snappy.SnappyCompressor.initIDs(Native Method)
	at org.apache.hadoop.io.compress.snappy.SnappyCompressor.<clinit>(SnappyCompressor.java:61)
	at org.apache.hadoop.io.compress.SnappyCodec.isNativeCodeLoaded(SnappyCodec.java:79)
	at org.apache.hadoop.util.NativeLibraryChecker.main(NativeLibraryChecker.java:82)
Native library checking:
hadoop:  true /opt/modules/hadoop-2.6.0/lib/native/libhadoop.so.1.0.0
zlib:    true /lib/x86_64-linux-gnu/libz.so.1
snappy:  false 
lz4:     true revision:99
bzip2:   false 
```
## 下载Hadoop源码
https://archive.apache.org/dist/hadoop/common/hadoop-2.6.0/hadoop-2.6.0-src.tar.gz
## 具体编译过程，看其他几个文件
